#:import dp kivy.metrics.dp

<MoreItem>:
    icon: "chevron-right"
    IconLeftWidget:
        icon: root.icon

RootSM:
    HomeScreen:
        name: "home"
    BossesScreen:
        name: "bosses"
    BoostedScreen:
        name: "boosted"
    TrainingScreen:
        name: "training"
    ImbuementsScreen:
        name: "imbuements"
    HuntScreen:
        name: "hunt"


<HomeScreen@MDScreen>:
    char_last_url: ""

    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Tibia Tools"
            elevation: 2

        MDBottomNavigation:
            panel_color: app.theme_cls.bg_normal

            MDBottomNavigationItem:
                name: "tab_char"
                text: "Char"
                icon: "account-search"

                MDScrollView:
                    do_scroll_x: False

                    MDBoxLayout:
                        orientation: "vertical"
                        adaptive_height: True
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(12)
                        spacing: dp(10)

                        MDTextField:
                            id: char_name
                            hint_text: "Nome do personagem"
                            mode: "rectangle"

                        MDRaisedButton:
                            text: "Buscar"
                            on_release: app.search_character()

                        MDRaisedButton:
                            text: "Abrir no Tibia.com"
                            on_release: app.open_last_in_browser()

                        MDRaisedButton:
                            text: "Favoritar"
                            on_release: app.add_current_to_favorites()

                        MDLabel:
                            id: char_status
                            text: "Faça uma busca."
                            halign: "left"
                            valign: "top"
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(20)

            MDBottomNavigationItem:
                name: "tab_share"
                text: "Share XP"
                icon: "account-group"

                MDScrollView:
                    do_scroll_x: False

                    MDBoxLayout:
                        orientation: "vertical"
                        adaptive_height: True
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(12)
                        spacing: dp(10)

                        MDLabel:
                            text: "Calculadora de Shared XP"
                            bold: True
                            size_hint_y: None
                            height: self.texture_size[1] + dp(8)

                        MDTextField:
                            id: share_level
                            hint_text: "Seu level"
                            mode: "rectangle"
                            input_filter: "int"

                        MDRaisedButton:
                            text: "Calcular"
                            on_release: app.calc_shared_xp()

                        MDLabel:
                            id: share_result
                            text: ""
                            halign: "left"
                            valign: "top"
                            text_size: self.width, None
                            size_hint_y: None
                            height: self.texture_size[1] + dp(20)

            MDBottomNavigationItem:
                name: "tab_fav"
                text: "Favoritos"
                icon: "star"

                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(8)
                    spacing: dp(8)

                    MDLabel:
                        text: "Toque em um favorito para opções."
                        size_hint_y: None
                        height: dp(24)

                    ScrollView:
                        MDList:
                            id: fav_list

            MDBottomNavigationItem:
                name: "tab_more"
                text: "Mais"
                icon: "dots-horizontal"

                ScrollView:
                    MDList:
                        MoreItem:
                            text: "Bosses (ExevoPan)"
                            icon: "skull"
                            on_release: app.open_more_target("bosses")
                        MoreItem:
                            text: "Boosted"
                            icon: "star-four-points"
                            on_release: app.open_more_target("boosted")
                        MoreItem:
                            text: "Treino (Exercise)"
                            icon: "dumbbell"
                            on_release: app.open_more_target("training")
                        MoreItem:
                            text: "Imbuements"
                            icon: "flash"
                            on_release: app.open_more_target("imbuements")
                        MoreItem:
                            text: "Hunt Analyzer"
                            icon: "chart-bar"
                            on_release: app.open_more_target("hunt")


<BossesScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Bosses (ExevoPan)"
            left_action_items: [["arrow-left", lambda *_: app.go_home()]]
            right_action_items: [["refresh", lambda *_: app.load_bosses()]]

        MDLabel:
            id: boss_status
            text: "Toque em refresh para carregar."
            size_hint_y: None
            height: dp(24)
            padding_x: dp(12)

        ScrollView:
            MDList:
                id: boss_list


<BoostedScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Boosted"
            left_action_items: [["arrow-left", lambda *_: app.go_home()]]
            right_action_items: [["refresh", lambda *_: app.update_boosted()]]

        MDLabel:
            id: boost_status
            text: "Carregando..."
            size_hint_y: None
            height: dp(24)
            padding_x: dp(12)

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDLabel:
                id: boost_creature
                text: ""
                halign: "left"

            MDLabel:
                id: boost_boss
                text: ""
                halign: "left"


<TrainingScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Treino (Exercise)"
            left_action_items: [["arrow-left", lambda *_: app.go_home()]]

        ScrollView:
            MDBoxLayout:
                orientation: "vertical"
                adaptive_height: True
                size_hint_y: None
                height: self.minimum_height
                padding: dp(12)
                spacing: dp(10)

                MDLabel:
                    text: "Mundo"
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1] + dp(6)

                MDTextField:
                    id: world_field
                    hint_text: "World"
                    mode: "rectangle"

                MDLabel:
                    text: "Vocação"
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1] + dp(6)

                MDTextField:
                    id: voc_drop
                    hint_text: "Vocation"
                    mode: "rectangle"
                    readonly: True
                    on_focus: if self.focus: app.open_dropdown("voc_menu")

                MDLabel:
                    text: "Skill"
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1] + dp(6)

                MDTextField:
                    id: skill_drop
                    hint_text: "Skill"
                    mode: "rectangle"
                    readonly: True
                    on_focus: if self.focus: app.open_dropdown("skill_menu")

                MDLabel:
                    text: "Arma"
                    bold: True
                    size_hint_y: None
                    height: self.texture_size[1] + dp(6)

                MDTextField:
                    id: weapon_drop
                    hint_text: "Weapon"
                    mode: "rectangle"
                    readonly: True
                    on_focus: if self.focus: app.open_dropdown("weapon_menu")

                MDBoxLayout:
                    orientation: "horizontal"
                    spacing: dp(10)

                    MDTextField:
                        id: from_level
                        hint_text: "From"
                        mode: "rectangle"
                        input_filter: "int"

                    MDTextField:
                        id: to_level
                        hint_text: "To"
                        mode: "rectangle"
                        input_filter: "int"

                MDTextField:
                    id: loyalty
                    hint_text: "Loyalty (%)"
                    mode: "rectangle"
                    input_filter: "int"

                MDBoxLayout:
                    orientation: "horizontal"
                    spacing: dp(12)
                    size_hint_y: None
                    height: dp(48)

                    MDCheckbox:
                        id: private_dummy
                        active: False
                    MDLabel:
                        text: "Private Dummy"
                        valign: "middle"

                MDBoxLayout:
                    orientation: "horizontal"
                    spacing: dp(12)
                    size_hint_y: None
                    height: dp(48)

                    MDCheckbox:
                        id: double_event
                        active: False
                    MDLabel:
                        text: "Double Event"
                        valign: "middle"

                MDRaisedButton:
                    text: "Calcular"
                    on_release: app.calc_training()

                MDLabel:
                    id: train_status
                    text: ""
                    size_hint_y: None
                    height: dp(24)

                MDTextField:
                    id: train_result
                    hint_text: "Resultado"
                    mode: "rectangle"
                    multiline: True
                    readonly: True
                    size_hint_y: None
                    height: dp(260)


<ImbuementsScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Imbuements"
            left_action_items: [["arrow-left", lambda *_: app.go_home()]]

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDTextField:
                id: imb_search
                hint_text: "Buscar (ex: Vampirism, Strike...)"
                mode: "rectangle"

            MDRaisedButton:
                text: "Buscar"
                on_release: app.imbu_search()

            MDLabel:
                id: imb_status
                text: ""
                size_hint_y: None
                height: dp(24)

        ScrollView:
            MDList:
                id: imb_list


<HuntScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Hunt Analyzer"
            left_action_items: [["arrow-left", lambda *_: app.go_home()]]

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDTextField:
                id: hunt_input
                hint_text: "Cole aqui o texto da sessão (analisador)"
                mode: "rectangle"
                multiline: True
                size_hint_y: None
                height: dp(220)

            MDRaisedButton:
                text: "Analisar"
                on_release: app.analyze_hunt()

            MDLabel:
                id: hunt_status
                text: ""
                size_hint_y: None
                height: dp(24)

            MDTextField:
                id: hunt_output
                hint_text: "Resultado"
                mode: "rectangle"
                multiline: True
                readonly: True
                size_hint_y: None
                height: dp(260)

#:import dp kivy.metrics.dp

<MoreItem>:
    icon: "chevron-right"
    IconLeftWidget:
        icon: root.icon

ScreenManager:
    id: screen_manager

    HomeTabs:
        name: "home"

    BossesScreen:
        name: "bosses"

    BoostedScreen:
        name: "boosted"

    TrainingScreen:
        name: "training"

    ImbuementsScreen:
        name: "imbuements"

    HuntScreen:
        name: "hunt"


<HomeScreen@MDScreen>:
    char_last: ""
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Tibia Tools"
            left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]

        MDNavigationLayout:
            MDNavigationDrawer:
                id: nav_drawer
                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(12)
                    spacing: dp(12)

                    MDLabel:
                        text: "Menu"
                        font_style: "H6"
                        size_hint_y: None
                        height: self.texture_size[1]

                    MDList:
                        OneLineIconListItem:
                            text: "Home"
                            on_release:
                                app.go("home")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "home"

                        OneLineIconListItem:
                            text: "Bosses"
                            on_release:
                                app.go("bosses")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "sword"

                        OneLineIconListItem:
                            text: "Boosted"
                            on_release:
                                app.go("boosted")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "fire"

                        OneLineIconListItem:
                            text: "Treino"
                            on_release:
                                app.go("training")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "dumbbell"

                        OneLineIconListItem:
                            text: "Imbuements"
                            on_release:
                                app.go("imbuements")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "alchemy"

                        OneLineIconListItem:
                            text: "Hunt Analyzer"
                            on_release:
                                app.go("hunt")
                                nav_drawer.set_state("close")
                            IconLeftWidget:
                                icon: "chart-line"

            MDTabs:
                id: tabs
                on_tab_switch: app.on_tab_switch(*args)

                MDTabsBase:
                    text: "Char"
                    MDBoxLayout:
                        orientation: "vertical"
                        padding: dp(12)
                        spacing: dp(12)

                        MDTextField:
                            id: char_name
                            hint_text: "Nome do personagem"
                            text: root.char_last

                        MDRectangleFlatButton:
                            text: "Buscar"
                            on_release: app.fetch_character()

                        MDLabel:
                            id: char_result
                            text: ""
                            halign: "left"
                            size_hint_y: None
                            height: self.texture_size[1]

                MDTabsBase:
                    text: "Bless"
                    MDBoxLayout:
                        orientation: "vertical"
                        padding: dp(12)
                        spacing: dp(12)

                        MDTextField:
                            id: bless_level
                            hint_text: "Level"
                            input_filter: "int"

                        MDRectangleFlatButton:
                            text: "Calcular"
                            on_release: app.calc_blessings()

                        MDLabel:
                            id: bless_result
                            text: ""
                            halign: "left"
                            size_hint_y: None
                            height: self.texture_size[1]

                MDTabsBase:
                    text: "Favoritos"
                    MDBoxLayout:
                        orientation: "vertical"
                        padding: dp(12)
                        spacing: dp(12)

                        MDTextField:
                            id: fav_name
                            hint_text: "Adicionar favorito (nome do char)"

                        MDRectangleFlatButton:
                            text: "Adicionar"
                            on_release: app.add_favorite()

                        ScrollView:
                            MDList:
                                id: favorites_list

                MDTabsBase:
                    text: "Mais"
                    ScrollView:
                        MDList:
                            OneLineIconListItem:
                                text: "Bosses (ExevoPan)"
                                on_release: app.go("bosses")
                                IconLeftWidget:
                                    icon: "sword"

                            OneLineIconListItem:
                                text: "Boosted"
                                on_release: app.go("boosted")
                                IconLeftWidget:
                                    icon: "fire"

                            OneLineIconListItem:
                                text: "Treino (Exercise)"
                                on_release: app.go("training")
                                IconLeftWidget:
                                    icon: "dumbbell"

                            OneLineIconListItem:
                                text: "Imbuements"
                                on_release: app.go("imbuements")
                                IconLeftWidget:
                                    icon: "alchemy"

                            OneLineIconListItem:
                                text: "Hunt Analyzer"
                                on_release: app.go("hunt")
                                IconLeftWidget:
                                    icon: "chart-line"


<BossesScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Bosses"
            left_action_items: [["arrow-left", lambda x: app.go("home")]]

        MDRectangleFlatButton:
            text: "Atualizar"
            pos_hint: {"center_x": .5}
            on_release: app.update_bosses()

        ScrollView:
            MDList:
                id: bosses_list


<BoostedScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Boosted"
            left_action_items: [["arrow-left", lambda x: app.go("home")]]

        MDRectangleFlatButton:
            text: "Atualizar"
            pos_hint: {"center_x": .5}
            on_release: app.update_boosted()

        MDLabel:
            id: boosted_label
            text: ""
            halign: "left"
            padding: dp(12), dp(12)
            size_hint_y: None
            height: self.texture_size[1]


<TrainingScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Treino"
            left_action_items: [["arrow-left", lambda x: app.go("home")]]

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDTextField:
                id: training_from
                hint_text: "Skill atual"
                input_filter: "int"

            MDTextField:
                id: training_to
                hint_text: "Skill alvo"
                input_filter: "int"

            MDTextField:
                id: training_ml
                hint_text: "Magic Level atual (opcional)"
                input_filter: "int"

            MDRectangleFlatButton:
                text: "Calcular"
                on_release: app.compute_training()

            MDLabel:
                id: training_result
                text: ""
                halign: "left"
                size_hint_y: None
                height: self.texture_size[1]


<ImbuementsScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Imbuements"
            left_action_items: [["arrow-left", lambda x: app.go("home")]]

        MDRectangleFlatButton:
            text: "Atualizar"
            pos_hint: {"center_x": .5}
            on_release: app.update_imbuements()

        ScrollView:
            MDList:
                id: imbuements_list


<HuntScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Hunt Analyzer"
            left_action_items: [["arrow-left", lambda x: app.go("home")]]

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDTextField:
                id: hunt_text
                hint_text: "Cole o texto do hunt (session data)"
                multiline: True
                size_hint_y: None
                height: dp(180)

            MDRectangleFlatButton:
                text: "Analisar"
                on_release: app.parse_hunt()

            MDLabel:
                id: hunt_result
                text: ""
                halign: "left"
                size_hint_y: None
                height: self.texture_size[1]

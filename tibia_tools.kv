#:import dp kivy.metrics.dp

<MoreItem>:
    icon: "chevron-right"
    IconLeftWidget:
        icon: root.icon

RootSM:
    HomeScreen:
        name: "home"
    BossesScreen:
        name: "bosses"
    BoostedScreen:
        name: "boosted"
    TrainingScreen:
        name: "training"
    ImbuementsScreen:
        name: "imbuements"
    HuntScreen:
        name: "hunt"


<HomeScreen@MDScreen>:
    char_last_url: ""
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Tibia Tools"
            elevation: 2

        MDBottomNavigation:
            panel_color: app.theme_cls.bg_normal

            MDBottomNavigationItem:
                name: "tab_char"
                text: "Char"
                icon: "account-search"

                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(12)
                    spacing: dp(10)

                    MDTextField:
                        id: char_name
                        hint_text: "Nome do personagem"
                        mode: "rectangle"

                    MDRaisedButton:
                        text: "Buscar"
                        on_release: app.search_character()

                    MDRaisedButton:
                        text: "Abrir no Tibia.com"
                        on_release: app.open_last_in_browser()

                    MDRaisedButton:
                        text: "Favoritar"
                        on_release: app.add_current_to_favorites()

                    MDLabel:
                        id: char_status
                        text: "Faça uma busca."
                        halign: "left"
                        valign: "top"
                        size_hint_y: None
                        height: self.texture_size[1] + dp(20)

            MDBottomNavigationItem:
                name: "tab_bless"
                text: "Bless"
                icon: "shield-check"

                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(12)
                    spacing: dp(10)

                    MDTextField:
                        id: bless_level
                        hint_text: "Level"
                        mode: "rectangle"
                        input_filter: "int"

                    MDBoxLayout:
                        size_hint_y: None
                        height: dp(48)
                        spacing: dp(10)

                        MDLabel:
                            text: "PvP:"
                            size_hint_x: None
                            width: dp(60)
                            valign: "middle"

                        MDSwitch:
                            id: bless_pvp
                            active: True

                    MDRaisedButton:
                        text: "Calcular"
                        on_release: app.calc_blessings()

                    MDLabel:
                        id: bless_result
                        text: ""
                        halign: "left"
                        valign: "top"

            MDBottomNavigationItem:
                name: "tab_fav"
                text: "Favoritos"
                icon: "star"

                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(8)
                    spacing: dp(8)

                    MDLabel:
                        text: "Toque em um favorito para opções."
                        size_hint_y: None
                        height: dp(24)

                    ScrollView:
                        MDList:
                            id: fav_list

            MDBottomNavigationItem:
                name: "tab_more"
                text: "Mais"
                icon: "dots-horizontal"

                ScrollView:
                    MDList:
                        MoreItem:
                            text: "Bosses (ExevoPan)"
                            icon: "skull"
                            on_release: app.open_more_target("bosses")
                        MoreItem:
                            text: "Boosted"
                            icon: "star-four-points"
                            on_release: app.open_more_target("boosted")
                        MoreItem:
                            text: "Treino (Exercise)"
                            icon: "dumbbell"
                            on_release: app.open_more_target("training")
                        MoreItem:
                            text: "Imbuements"
                            icon: "flash"
                            on_release: app.open_more_target("imbuements")
                        MoreItem:
                            text: "Hunt Analyzer"
                            icon: "chart-bar"
                            on_release: app.open_more_target("hunt")


<BossesScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Bosses (ExevoPan)"
            left_action_items: [["arrow-left", lambda x: app.back_home()]]
            elevation: 2

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDBoxLayout:
                size_hint_y: None
                height: dp(56)
                spacing: dp(8)

                MDTextField:
                    id: world_field
                    hint_text: "World"
                    mode: "rectangle"

                MDIconButton:
                    id: world_drop
                    icon: "menu-down"
                    on_release:
                        if app._menu_world: app._menu_world.open()

            MDRaisedButton:
                text: "Buscar Bosses"
                on_release: app.bosses_fetch()

            MDLabel:
                id: boss_status
                text: ""
                size_hint_y: None
                height: self.texture_size[1] + dp(10)

            ScrollView:
                MDList:
                    id: boss_list


<BoostedScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Boosted"
            left_action_items: [["arrow-left", lambda x: app.back_home()]]
            right_action_items: [["refresh", lambda x: app.update_boosted()]]
            elevation: 2

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(12)

            MDLabel:
                id: boost_status
                text: ""
                size_hint_y: None
                height: dp(24)

            MDCard:
                padding: dp(12)
                size_hint_y: None
                height: dp(120)
                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(6)
                    MDLabel:
                        text: "Boosted Creature:"
                        bold: True
                    MDLabel:
                        id: boost_creature
                        text: "-"
                    MDLabel:
                        text: "Boosted Boss:"
                        bold: True
                    MDLabel:
                        id: boost_boss
                        text: "-"


<TrainingScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Treino (Exercise)"
            left_action_items: [["arrow-left", lambda x: app.back_home()]]
            elevation: 2

        ScrollView:
            MDBoxLayout:
                orientation: "vertical"
                padding: dp(12)
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

                MDBoxLayout:
                    size_hint_y: None
                    height: dp(56)
                    spacing: dp(8)

                    MDTextField:
                        id: skill_field
                        hint_text: "Skill"
                        text: "Sword"
                        mode: "rectangle"
                        readonly: True

                    MDIconButton:
                        id: skill_drop
                        icon: "menu-down"
                        on_release:
                            if app._menu_skill: app._menu_skill.open()

                MDBoxLayout:
                    size_hint_y: None
                    height: dp(56)
                    spacing: dp(8)

                    MDTextField:
                        id: from_level
                        hint_text: "De"
                        mode: "rectangle"
                        input_filter: "int"

                    MDTextField:
                        id: to_level
                        hint_text: "Até"
                        mode: "rectangle"
                        input_filter: "int"

                MDTextField:
                    id: loyalty
                    hint_text: "Loyalty (%) (0-50)"
                    mode: "rectangle"
                    input_filter: "float"
                    text: "0"

                MDBoxLayout:
                    size_hint_y: None
                    height: dp(48)
                    spacing: dp(10)
                    MDLabel:
                        text: "Private dummy (+10%):"
                        valign: "middle"
                    MDSwitch:
                        id: private_dummy
                        active: False

                MDBoxLayout:
                    size_hint_y: None
                    height: dp(48)
                    spacing: dp(10)
                    MDLabel:
                        text: "Double event (x2):"
                        valign: "middle"
                    MDSwitch:
                        id: double_event
                        active: False

                MDRaisedButton:
                    text: "Calcular"
                    on_release: app.training_calculate()

                MDLabel:
                    id: train_status
                    text: ""
                    size_hint_y: None
                    height: dp(24)

                MDLabel:
                    id: train_result
                    text: ""
                    halign: "left"
                    valign: "top"
                    size_hint_y: None
                    height: self.texture_size[1] + dp(20)


<ImbuementsScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Imbuements (TibiaWiki)"
            left_action_items: [["arrow-left", lambda x: app.back_home()]]
            right_action_items: [["refresh", lambda x: app._imbuements_load()]]
            elevation: 2

        MDBoxLayout:
            orientation: "vertical"
            padding: dp(12)
            spacing: dp(10)

            MDTextField:
                id: imb_search
                hint_text: "Buscar (ex: Vampirism, Strike...)"
                mode: "rectangle"
                on_text: app.imbuements_refresh_list()

            MDLabel:
                id: imb_status
                text: "Toque em refresh para carregar."
                size_hint_y: None
                height: dp(24)

            ScrollView:
                MDList:
                    id: imb_list


<HuntScreen@MDScreen>:
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Hunt Analyzer"
            left_action_items: [["arrow-left", lambda x: app.back_home()]]
            elevation: 2

        ScrollView:
            MDBoxLayout:
                orientation: "vertical"
                padding: dp(12)
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

                MDTextField:
                    id: hunt_input
                    hint_text: "Cole aqui o texto do Session Data (Tibia)"
                    mode: "rectangle"
                    multiline: True
                    size_hint_y: None
                    height: dp(220)

                MDRaisedButton:
                    text: "Analisar"
                    on_release: app.hunt_parse()

                MDLabel:
                    id: hunt_status
                    text: ""
                    size_hint_y: None
                    height: dp(24)

                MDTextField:
                    id: hunt_output
                    hint_text: "Resultado"
                    mode: "rectangle"
                    multiline: True
                    readonly: True
                    size_hint_y: None
                    height: dp(260)
